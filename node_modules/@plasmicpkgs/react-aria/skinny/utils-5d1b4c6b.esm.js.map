{"version":3,"file":"utils-5d1b4c6b.esm.js","sources":["../src/utils.ts"],"sourcesContent":["import {\n  usePlasmicCanvasComponentInfo,\n  usePlasmicCanvasContext,\n  type CodeComponentMeta,\n} from \"@plasmicapp/host\";\nimport registerComponent from \"@plasmicapp/host/registerComponent\";\nimport React, { useEffect } from \"react\";\n\nexport type HasControlContextData<T = BaseControlContextData> = {\n  setControlContextData?: (ctxData: T) => void;\n};\n\nexport type BaseControlContextData = {\n  parent?: {\n    isDisabled?: boolean;\n    isReadOnly?: boolean;\n  };\n};\n\nexport type Registerable = {\n  registerComponent: typeof registerComponent;\n};\n\nexport type OtherCodeComponentsMeta = {\n  text: CodeComponentMeta<any>;\n  description: CodeComponentMeta<any>;\n};\n\nexport type CodeComponentMetaOverrides<T extends React.ComponentType<any>> =\n  Partial<\n    Pick<\n      CodeComponentMeta<React.ComponentProps<T>>,\n      \"parentComponentName\" | \"props\" | \"displayName\" | \"name\"\n    >\n  >;\n\nexport function useAutoOpen({\n  props,\n  open,\n  close,\n}: {\n  props: any;\n  open?: () => void;\n  close?: () => void;\n}) {\n  const inPlasmicCanvas = !!usePlasmicCanvasContext();\n  const isSelected =\n    usePlasmicCanvasComponentInfo?.(props)?.isSelected ?? false;\n\n  useEffect(() => {\n    // selection in outline tab only matters in canvas\n    if (!inPlasmicCanvas) {\n      return;\n    }\n    if (isSelected) {\n      open?.();\n    } else {\n      close?.();\n    }\n    // Not putting open and close in the useEffect dependencies array, because it causes a re-render loop.\n  }, [isSelected, inPlasmicCanvas]);\n}\n\nexport function registerComponentHelper<T extends React.ComponentType<any>>(\n  loader: Registerable | undefined,\n  component: T,\n  meta: CodeComponentMeta<React.ComponentProps<T>>,\n  overrides?: CodeComponentMetaOverrides<T>\n) {\n  if (overrides) {\n    meta = {\n      ...meta,\n      ...overrides,\n      props: {\n        ...meta.props,\n        ...overrides.props,\n      },\n    };\n    if (overrides.parentComponentName) {\n      meta.name = makeChildComponentName(\n        overrides.parentComponentName,\n        meta.name\n      );\n    }\n  }\n  if (loader) {\n    loader.registerComponent(component, meta);\n  } else {\n    registerComponent(component, meta);\n  }\n  return meta;\n}\n\nexport function makeComponentName(name: string) {\n  return `plasmic-react-aria-${name}`;\n}\n\nexport function makeChildComponentName(\n  fullParentName: string | undefined,\n  fullChildName: string\n) {\n  if (!fullParentName) {\n    return fullChildName;\n  }\n  return `${fullParentName}-${fullChildName.replace(\n    \"plasmic-react-aria-\",\n    \"\"\n  )}`;\n}\n\nexport interface Styleable {\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nexport function extractPlasmicDataProps(props: Record<string, any>) {\n  return Object.fromEntries(\n    Object.entries(props).filter(([key]) => key.startsWith(\"data-plasmic-\"))\n  );\n}\n\nexport function withoutNils<T>(array: (T | undefined | null)[]) {\n  return array.filter((x): x is T => x != null);\n}\n\nexport function isDefined<T>(thing: T | undefined | null): thing is T {\n  return thing !== undefined && thing !== null;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAoCO,SAAS,WAAY,CAAA;AAAA,EAC1B,KAAA;AAAA,EACA,IAAA;AAAA,EACA,KAAA;AACF,CAIG,EAAA;AA5CH,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA;AA6CE,EAAM,MAAA,eAAA,GAAkB,CAAC,CAAC,uBAAwB,EAAA,CAAA;AAClD,EAAA,MAAM,UACJ,GAAA,CAAA,EAAA,GAAA,CAAA,EAAA,GAAA,CAAA,EAAA,GAAA,6BAAA,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAgC,KAAhC,CAAA,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAwC,eAAxC,IAAsD,GAAA,EAAA,GAAA,KAAA,CAAA;AAExD,EAAA,SAAA,CAAU,MAAM;AAEd,IAAA,IAAI,CAAC,eAAiB,EAAA;AACpB,MAAA,OAAA;AAAA,KACF;AACA,IAAA,IAAI,UAAY,EAAA;AACd,MAAA,IAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,IAAA,EAAA,CAAA;AAAA,KACK,MAAA;AACL,MAAA,KAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,KAAA,EAAA,CAAA;AAAA,KACF;AAAA,GAEC,EAAA,CAAC,UAAY,EAAA,eAAe,CAAC,CAAA,CAAA;AAClC,CAAA;AAEO,SAAS,uBACd,CAAA,MAAA,EACA,SACA,EAAA,IAAA,EACA,SACA,EAAA;AACA,EAAA,IAAI,SAAW,EAAA;AACb,IAAO,IAAA,GAAA,aAAA,CAAA,cAAA,CAAA,cAAA,CAAA,EAAA,EACF,OACA,SAFE,CAAA,EAAA;AAAA,MAGL,KAAO,EAAA,cAAA,CAAA,cAAA,CAAA,EAAA,EACF,IAAK,CAAA,KAAA,CAAA,EACL,SAAU,CAAA,KAAA,CAAA;AAAA,KAEjB,CAAA,CAAA;AACA,IAAA,IAAI,UAAU,mBAAqB,EAAA;AACjC,MAAA,IAAA,CAAK,IAAO,GAAA,sBAAA;AAAA,QACV,SAAU,CAAA,mBAAA;AAAA,QACV,IAAK,CAAA,IAAA;AAAA,OACP,CAAA;AAAA,KACF;AAAA,GACF;AACA,EAAA,IAAI,MAAQ,EAAA;AACV,IAAO,MAAA,CAAA,iBAAA,CAAkB,WAAW,IAAI,CAAA,CAAA;AAAA,GACnC,MAAA;AACL,IAAA,iBAAA,CAAkB,WAAW,IAAI,CAAA,CAAA;AAAA,GACnC;AACA,EAAO,OAAA,IAAA,CAAA;AACT,CAAA;AAEO,SAAS,kBAAkB,IAAc,EAAA;AAC9C,EAAA,OAAO,CAAsB,mBAAA,EAAA,IAAA,CAAA,CAAA,CAAA;AAC/B,CAAA;AAEgB,SAAA,sBAAA,CACd,gBACA,aACA,EAAA;AACA,EAAA,IAAI,CAAC,cAAgB,EAAA;AACnB,IAAO,OAAA,aAAA,CAAA;AAAA,GACT;AACA,EAAO,OAAA,CAAA,EAAG,kBAAkB,aAAc,CAAA,OAAA;AAAA,IACxC,qBAAA;AAAA,IACA,EAAA;AAAA,GACF,CAAA,CAAA,CAAA;AACF,CAAA;AAOO,SAAS,wBAAwB,KAA4B,EAAA;AAClE,EAAA,OAAO,MAAO,CAAA,WAAA;AAAA,IACZ,MAAO,CAAA,OAAA,CAAQ,KAAK,CAAA,CAAE,MAAO,CAAA,CAAC,CAAC,GAAG,CAAM,KAAA,GAAA,CAAI,UAAW,CAAA,eAAe,CAAC,CAAA;AAAA,GACzE,CAAA;AACF,CAAA;AAMO,SAAS,UAAa,KAAyC,EAAA;AACpE,EAAO,OAAA,KAAA,KAAU,UAAa,KAAU,KAAA,IAAA,CAAA;AAC1C;;;;"}